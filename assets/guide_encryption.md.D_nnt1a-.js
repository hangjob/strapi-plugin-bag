import{_ as a,c as i,o as t,ag as n}from"./chunks/framework.4MsdTtZo.js";const c=JSON.parse('{"title":"加密工具指南","description":"","frontmatter":{},"headers":[],"relativePath":"guide/encryption.md","filePath":"guide/encryption.md"}'),e={name:"guide/encryption.md"};function l(p,s,h,o,r,d){return t(),i("div",null,[...s[0]||(s[0]=[n(`<h1 id="加密工具指南" tabindex="-1">加密工具指南 <a class="header-anchor" href="#加密工具指南" aria-label="Permalink to &quot;加密工具指南&quot;">​</a></h1><p><code>strapi-plugin-bag</code> 提供了一套开箱即用的加密工具集，支持 <strong>RSA 非对称加密</strong> 和 <strong>AES 对称加密</strong>。这对于在前后端之间传输敏感数据（如密码、身份证号）或在数据库中存储隐私信息非常有用。</p><p>本插件的加密实现与现代 Web Crypto API 兼容，支持与前端 SDK 无缝互通。</p><h2 id="概览" tabindex="-1">概览 <a class="header-anchor" href="#概览" aria-label="Permalink to &quot;概览&quot;">​</a></h2><h3 id="_1-非对称加密-rsa" tabindex="-1">1. 非对称加密 (RSA) <a class="header-anchor" href="#_1-非对称加密-rsa" aria-label="Permalink to &quot;1. 非对称加密 (RSA)&quot;">​</a></h3><ul><li><strong>适用场景</strong>: 前端加密传输密码，后端解密。</li><li><strong>算法</strong>: <code>RSA-OAEP</code></li><li><strong>参数</strong>: Hash: <code>SHA-256</code>, Modulus Length: <code>2048</code></li><li><strong>原理</strong>: 插件启动时自动生成临时 RSA 密钥对（存内存）。前端获取公钥加密，后端使用私钥解密。</li><li><strong>注意</strong>: 密钥对在服务器重启后会重置（更安全，但不能用于持久化存储加密数据）。</li></ul><h3 id="_2-对称加密-aes" tabindex="-1">2. 对称加密 (AES) <a class="header-anchor" href="#_2-对称加密-aes" aria-label="Permalink to &quot;2. 对称加密 (AES)&quot;">​</a></h3><ul><li><strong>适用场景</strong>: 系统内部加密存储（如身份证号），或服务端之间通信。</li><li><strong>算法</strong>: <code>AES-256-GCM</code> (相比 CBC 模式，GCM 提供了认证加密，更安全且无需手动 Padding)。</li><li><strong>格式</strong>: Base64 编码的 <code>[Ciphertext + AuthTag(16 bytes) + IV(12 bytes)]</code>。</li><li><strong>配置</strong>: 建议在 <code>.env</code> 中设置 <code>AES_SECRET</code> 以保证密钥持久化。否则默认使用临时随机密钥（重启后旧数据无法解密）。</li></ul><hr><h2 id="环境变量配置" tabindex="-1">环境变量配置 <a class="header-anchor" href="#环境变量配置" aria-label="Permalink to &quot;环境变量配置&quot;">​</a></h2><p>如果使用 AES 加密进行持久化存储，<strong>必须</strong>设置以下环境变量：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 32字节的字符串 (会自动进行 Scrypt 派生)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">AES_SECRET</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">your_secure_secret_key_here</span></span></code></pre></div><hr><h2 id="api-参考" tabindex="-1">API 参考 <a class="header-anchor" href="#api-参考" aria-label="Permalink to &quot;API 参考&quot;">​</a></h2><p>所有插件接口的基础路径为 <code>/api/strapi-plugin-bag</code>。</p><h3 id="_1-获取-rsa-公钥" tabindex="-1">1. 获取 RSA 公钥 <a class="header-anchor" href="#_1-获取-rsa-公钥" aria-label="Permalink to &quot;1. 获取 RSA 公钥&quot;">​</a></h3><p>前端在加密前，需要先调用此接口获取当前的公钥。</p><p><strong>接口地址:</strong> <code>GET /utils/rsa/public-key</code></p><p><strong>响应:</strong></p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;publicKey&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;-----BEGIN PUBLIC KEY-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A...&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="_2-rsa-加密" tabindex="-1">2. RSA 加密 <a class="header-anchor" href="#_2-rsa-加密" aria-label="Permalink to &quot;2. RSA 加密&quot;">​</a></h3><p>使用服务器公钥加密数据（通常由前端 JS 库完成，但也提供后端接口）。</p><p><strong>接口地址:</strong> <code>POST /utils/rsa/encrypt</code></p><p><strong>请求体:</strong></p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hello world&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>响应:</strong></p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;encrypted&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;L8/...&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // Base64 格式的加密字符串</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="_3-rsa-解密" tabindex="-1">3. RSA 解密 <a class="header-anchor" href="#_3-rsa-解密" aria-label="Permalink to &quot;3. RSA 解密&quot;">​</a></h3><p>使用服务器私钥解密数据。常用于解密前端传来的敏感字段。</p><p><strong>接口地址:</strong> <code>POST /utils/rsa/decrypt</code></p><p><strong>请求体:</strong></p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;L8/...&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // Base64 格式的加密字符串</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>响应:</strong></p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;decrypted&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hello world&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><hr><h3 id="_4-aes-加密" tabindex="-1">4. AES 加密 <a class="header-anchor" href="#_4-aes-加密" aria-label="Permalink to &quot;4. AES 加密&quot;">​</a></h3><p>使用 AES-256-GCM 算法加密数据。</p><p><strong>接口地址:</strong> <code>POST /utils/aes/encrypt</code></p><p><strong>请求体:</strong></p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;sensitive data&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>响应:</strong></p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;encrypted&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;YmFzZTY0Li4u&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // Base64 字符串 (包含密文、Tag 和 IV)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="_5-aes-解密" tabindex="-1">5. AES 解密 <a class="header-anchor" href="#_5-aes-解密" aria-label="Permalink to &quot;5. AES 解密&quot;">​</a></h3><p>解密 AES 加密的数据。</p><p><strong>接口地址:</strong> <code>POST /utils/aes/decrypt</code></p><p><strong>请求体:</strong></p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;YmFzZTY0Li4u&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>响应:</strong></p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;decrypted&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;sensitive data&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div>`,49)])])}const g=a(e,[["render",l]]);export{c as __pageData,g as default};
